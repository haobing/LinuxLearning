#include<stdio.h>
#include<stdlib.h>
#include<string.h>
#include<unistd.h>
#include<sys/types.h>
#include<fcntl.h>
#include<sys/stat.h>
#define PATH "/text"
int main()
{
int fd,res;
char buf[20];
pid_t pid;
unlink(PATH);
if((res=access(PATH,F_OK))==-1)
{
fputs("creat the fifo \n",stdout);
mkfifo(PATH,0777);
}
printf("creat the fork\n");
pid=fork();
if(pid==0)
{
fd=open(PATH,O_WRONLY);
printf("the haizi fd=%d\n",fd);
sprintf(buf,"wo shi haizi pid=%d\n",getpid());
write(fd,buf,strlen(buf));
}
else if(pid>0)
{
fd=open(PATH,O_RDONLY);
memset(buf,0,sizeof(buf));
read(fd,buf,sizeof(buf));
printf("the fathe :%s\n",buf);

}
else
{printf("error fork\n");
}
}
